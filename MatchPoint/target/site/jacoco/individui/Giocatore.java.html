<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="it"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>Giocatore.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">MatchPoint</a> &gt; <a href="index.source.html" class="el_package">individui</a> &gt; <span class="el_source">Giocatore.java</span></div><h1>Giocatore.java</h1><pre class="source lang-java linenums">/**
 * Il package individui contiene la definizione delle classi relative agli individui.
 */
package individui;

import java.sql.Connection;
import java.sql.SQLException;
import java.time.LocalDate;
import java.time.Period;
import java.time.format.DateTimeFormatter;

import components.Campo;
import dataBase.DataBase;

//--------------------------------------------------------
//Code generated by Papyrus Java
//--------------------------------------------------------

/**
 * Classe che rappresenta un giocatore nel sistema.
 * Estende la classe Utente e aggiunge attributi e funzionalità specifiche.
 */
public class Giocatore extends Utente {

    public Campo[] campo;

    /**
     * Costruttore di default per la classe Giocatore.
     */
    public Giocatore() {
<span class="nc" id="L31">        super();</span>
<span class="nc" id="L32">    }</span>

    /**
     * Metodo per registrare un nuovo giocatore nel sistema.
     *
     * @param conn        La connessione al database.
     * @param nome        Il nome del giocatore.
     * @param cognome     Il cognome del giocatore.
     * @param dataNascita La data di nascita del giocatore in formato &quot;yyyy-MM-dd&quot;.
     * @param email       L'email del giocatore.
     * @param username    Lo username del giocatore.
     * @param password    La password del giocatore.
     * @param nomeSquadra Il nome della squadra del giocatore.
     * @return 1 se la registrazione ha successo, -3 se lo username è già in uso, -4 se l'email è già in uso.
     */
    public static int registrazione(Connection conn, String nome, String cognome, String dataNascita, String email, String username,
                                     String password, String nomeSquadra) {
        int eta;

        // Calcolo dell'età basato sulla data di nascita
<span class="fc" id="L52">        DateTimeFormatter formatter = DateTimeFormatter.ofPattern(&quot;yyyy-MM-dd&quot;);</span>
<span class="fc" id="L53">        LocalDate nascita = LocalDate.parse(dataNascita, formatter);</span>
<span class="fc" id="L54">        LocalDate oggi = LocalDate.now();</span>
<span class="fc" id="L55">        Period periodo = Period.between(nascita, oggi);</span>
<span class="fc" id="L56">        eta = periodo.getYears();</span>

        // Query per verificare se lo username o l'email esistono già
<span class="fc" id="L59">        String sqlUsername = &quot;SELECT Password FROM Gestore WHERE Username ='&quot; + username + &quot;' UNION SELECT Password FROM Giocatore WHERE Username ='&quot; + username + &quot;'&quot;;</span>
<span class="fc" id="L60">        String sqlEmail = &quot;SELECT Password FROM Gestore WHERE Email ='&quot; + email + &quot;' UNION SELECT Password FROM Giocatore WHERE Email ='&quot; + email + &quot;'&quot;;</span>
<span class="fc" id="L61">        String risUsername = &quot;&quot;;</span>
<span class="fc" id="L62">        String risEmail = &quot;&quot;;</span>

        try {
<span class="fc" id="L65">            risUsername = DataBase.eseguiSelect(conn, sqlUsername); // Controllo username</span>
<span class="fc" id="L66">            risEmail = DataBase.eseguiSelect(conn, sqlEmail);       // Controllo email</span>
<span class="nc" id="L67">        } catch (SQLException e) {</span>
<span class="nc" id="L68">            e.printStackTrace();</span>
<span class="fc" id="L69">        }</span>

        // Gestione dei controlli
<span class="fc bfc" id="L72" title="All 2 branches covered.">        if (!risUsername.equals(&quot;&quot;)) {</span>
<span class="fc" id="L73">            return -3; // Username già in uso</span>
        } 
<span class="fc bfc" id="L75" title="All 2 branches covered.">        if (!risEmail.equals(&quot;&quot;)) {</span>
<span class="fc" id="L76">            return -4; // Email già in uso</span>
        }

        // Se username ed email non esistono, registra il nuovo giocatore
        try {
<span class="fc" id="L81">            DataBase.insert(conn, nome, cognome, dataNascita, eta, email, username, password, nomeSquadra);</span>
<span class="nc" id="L82">        } catch (SQLException e) {</span>
<span class="nc" id="L83">            e.printStackTrace();</span>
<span class="nc" id="L84">            return -1; // Errore generico</span>
<span class="fc" id="L85">        }</span>
<span class="fc" id="L86">        return 1; // Registrazione avvenuta con successo</span>
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.10.202304240956</span></div></body></html>